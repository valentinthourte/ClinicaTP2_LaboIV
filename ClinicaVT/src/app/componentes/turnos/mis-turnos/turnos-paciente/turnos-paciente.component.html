<div class="container py-4">
  <h4 class="mb-4">Mis Turnos</h4>

  <div class="input-group mb-4">
    <input type="text" class="form-control" placeholder="Filtrar por especialidad o especialista"
           [(ngModel)]="filtro" (ngModelChange)="filtrarTurnos()" />
    <span class="input-group-text">
      <i class="bi bi-search"></i>
    </span>
  </div>

  
  <div class="table-responsive">
    <table class="table table-hover table-bordered">
      <thead class="table-light">
        <tr>
          <th>Fecha</th>
          <th>Especialidad</th>
          <th>Especialista</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let turno of turnosFiltrados">
          <td>{{ turno.fecha | date:'short' }}</td>
          <td>{{ turno.especialidad }}</td>
          <td>{{ obtenerNombreEspecialista(turno.especialistaId) }}</td>
          <td>
            <span class="badge bg-secondary" *ngIf="turno.estado === 'pendiente'">Pendiente</span>
            <span class="badge bg-success" *ngIf="turno.estado === 'aceptado'">Aceptado</span>
            <span class="badge bg-danger" *ngIf="turno.estado === 'cancelado'">Cancelado</span>
            <span class="badge bg-warning text-dark" *ngIf="turno.estado === 'rechazado'">Rechazado</span>
            <span class="badge bg-primary" *ngIf="turno.estado === 'realizado'">Realizado</span>
          </td>
          <td>
            
            <button *ngIf="turno.estado === 'pendiente'" class="btn btn-sm btn-outline-danger me-2"
                    (click)="cancelarTurno(turno)">
              <i class="bi bi-x-circle"></i> Cancelar
            </button>

            
            <button *ngIf="turno.reseniaPaciente" class="btn btn-sm btn-outline-secondary me-2"
                    (click)="verResenia(turno)">
              <i class="bi bi-eye"></i> Ver resenia
            </button>

            
            <button *ngIf="turno.estado === 'realizado' && !turno.reseniaPaciente"
                    class="btn btn-sm btn-outline-primary me-2"
                    (click)="completarEncuesta(turno)">
              <i class="bi bi-journal-text"></i> Encuesta
            </button>

            
            <button *ngIf="turno.estado === 'realizado' && !turno.reseniaPaciente"
                    class="btn btn-sm btn-outline-success"
                    (click)="calificarAtencion(turno)">
              <i class="bi bi-star"></i> Calificar
            </button>
          </td>
        </tr>

        <tr *ngIf="turnosFiltrados.length === 0">
          <td colspan="5" class="text-center text-muted py-3">No hay turnos disponibles.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
